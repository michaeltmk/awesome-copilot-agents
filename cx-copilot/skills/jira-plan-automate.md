---
name: jira-plan-automate
description: Automatically save plans to Jira as tasks in the Data Science project. Use when the user wants to save a plan created by an agent into Jira.
license: MIT
compatibility: Requires access to Atlassian MCP tools.
metadata:
  author: GitHub Copilot
  version: "1.0"
---

# Save Plan to Jira

Automatically create Jira tasks from plans generated by interactive agents with preset defaults.

## When to Use

- User requests to save a plan to Jira
- User asks to "create tasks from plan" or "save this to Jira"
- After generating a multi-step plan and user wants to track it

## Default Values

When saving a plan to Jira, use these defaults unless user specifies otherwise:

| Field | Default Value | Notes |
|-------|--------------|-------|
| **Project** | `DS` | Data Science project |
| **Issue Type** | `Task` | Issue type ID: `10001` |
| **Assignee** | Current user | Get via `mcp_atlassian_atl_atlassianUserInfo` |
| **Cloud ID** | Auto-detect | Get via `mcp_atlassian_atl_getAccessibleAtlassianResources` |
| **Summary** | Plan title/name | First line or title of the plan |
| **Description** | Plan details | Full plan details with formatting plus repo URL |
| **Web Links** | Git repository URL | Include repo URL in description |
| **Epic** | User-selected epic | List all epics in DS and suggest one |
| **Feature** | User-selected feature | List all features under selected epic and suggest one |

## Workflow

### Step 1: Get Required Information

First, gather the necessary information:

```bash
# Get current user info
mcp_atlassian_atl_atlassianUserInfo()

# Get cloud ID
mcp_atlassian_atl_getAccessibleAtlassianResources()
```

### Step 2: List and Suggest Epics

Search the DS project for epics **excluding Done status**, list all results for user review, and suggest one:

```bash
mcp_atlassian_atl_searchJiraIssuesUsingJql(
    cloudId='185c3776-e3b3-43d4-93e2-db06ed56cd45',
    jql='project = DS AND issuetype = Epic AND status NOT IN (Done, Accepted) ORDER BY updated DESC',
    fields=['summary', 'status', 'assignee']
)
```

### Step 3: List and Suggest Features Under the Epic

After the user selects an epic, list features (custom issue type) under that epic **excluding Done status**, and suggest one:

```bash
mcp_atlassian_atl_searchJiraIssuesUsingJql(
    cloudId='185c3776-e3b3-43d4-93e2-db06ed56cd45',
    jql='project = DS AND issuetype = Feature AND "Epic Link" = DS-XXXX AND status NOT IN (Done, Accepted) ORDER BY updated DESC',
    fields=['summary', 'status', 'assignee']
)
```

### Step 4: Create a Single Task from Plan

Create one task that contains the full plan details (including the repo URL) in the description:

```bash
mcp_atlassian_atl_createJiraIssue(
    cloudId='185c3776-e3b3-43d4-93e2-db06ed56cd45',
    projectKey='DS',
    issueTypeName='Task',
    summary='[Plan title/name]',
    description='[Full plan details]\n\nRepo: https://github.com/<org>/<repo>',
    assignee={'accountId': '[current-user-account-id]'},
    parent={'key': 'DS-EPIC'}
)
```

### Step 5: Link the Task to the Feature

Add a link "is the story of (feature)" to the selected feature:

```bash
mcp_atlassian_atl_linkJiraIssues(
    cloudId='185c3776-e3b3-43d4-93e2-db06ed56cd45',
    issueKey='DS-TASK',
    linkedIssueKey='DS-FEATURE',
    linkType='is the story of (feature)'
)
```

### Step 6: Confirm the Single Task

Provide the created issue link to the user.

## Examples

### Example 1: Save Simple Plan

**User Plan:**
```
Plan: Implement ML Pipeline
1. Data preprocessing
2. Model training
3. Model evaluation
4. Deployment
```

**Actions:**
1. Get user info and cloud ID
2. List all active (non-Done) epics in DS, suggest one, and wait for user selection
3. List all active (non-Done) features under the selected epic, suggest one, and wait for user selection
4. Create a single task in DS project with the full plan details and repo URL in the description, and assign it to the selected epic
5. Link the task to the selected feature using "is the story of (feature)"

### Example 2: Save Plan with Parent Epic

**User Request:** "Save this plan under Epic DS-9500"

**Actions:**
1. Get user info and cloud ID
2. List all active (non-Done) epics in DS, suggest one, and wait for user selection
3. List all active (non-Done) features under the selected epic, suggest one, and wait for user selection
4. Create a single task with parent link and the full plan details plus repo URL in the description:

```bash
mcp_atlassian_atl_createJiraIssue(
    cloudId='185c3776-e3b3-43d4-93e2-db06ed56cd45',
    projectKey='DS',
    issueTypeName='Task',
    summary='Implement ML Pipeline',
    description='Data preprocessing\nModel training\nModel evaluation\nDeployment\n\nRepo: https://github.com/<org>/<repo>',
    assignee={'accountId': 'user-account-id'},
    parent={'key': 'DS-9500'}
)
```
5. Link the task to the selected feature using "is the story of (feature)".
6. Provide the created issue link to the user.

## Plan Format Recognition

Recognize various plan formats:

**Numbered List:**
```
1. Step one
2. Step two
3. Step three
```

**Bullet Points:**
```
- Task A
- Task B
- Task C
```

**Checklist:**
```
[ ] Todo item 1
[ ] Todo item 2
[ ] Todo item 3
```

**Markdown Headers:**
```
### Phase 1
Details...

### Phase 2
Details...
```

## Best Practices

1. **Confirm Before Creating**: Ask user to confirm before creating the task
2. **Show Summary**: Display a summary of what will be created:
    - "I will create 1 task in DS project assigned to you"
3. **Provide Links**: After creation, provide the created issue link
4. **Group Related Tasks**: If plan has phases/groups, consider creating an Epic first
5. **Preserve Context**: Include relevant context from the plan and the repo URL in the description
6. **Epic/Feature Review**: Always list all active (non-Done) epics and features for the user and suggest one before proceeding
7. **Skip Completed Work**: Exclude epics and features with status "Done" or "Accepted" from search results to focus on active work items
8. **Feature Terminology**: Note that "Feature" is a custom issue type in DS project, not a Story. Use `issuetype = Feature` in JQL queries

## Error Handling

If creation fails:
- Verify cloud ID and project access
- Check if user has permission to create issues in DS project
- Validate issue type name (should be "Task" not "task")
- Ensure assignee account ID is valid

## Advanced Options

### Add Labels

Tag tasks from automated plans:

```bash
mcp_atlassian_atl_createJiraIssue(
    ...
    labels=['generated-plan', 'ml-pipeline']
)
```

### Set Priority

If plan indicates priority:

```bash
mcp_atlassian_atl_createJiraIssue(
    ...
    priority={'name': 'Medium'}  # or 'High', 'Low'
)
```

## Sample Implementation

**User:** "Save this plan to Jira"

**Plan:**
```
Project Setup
- Create repository
- Set up development environment
- Configure CI/CD pipeline
```

**Agent Response:**
```
I'll create 1 task in the DS project assigned to you with the full plan details and repo URL in the description. Proceed? (yes/no)
```

**After confirmation:**
```
âœ“ Created DS-1234: Project Setup

View your task: https://cathaypacific-prod.atlassian.net/browse/DS-1234
``` 